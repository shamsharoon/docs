{
  "openapi": "3.1.0",
  "info": {
    "title": "GoTransit API",
    "description": "Real-time transit information for GO Transit services in the Greater Toronto Area",
    "version": "1.0.0",
    "contact": {
      "name": "GoTransit API Support"
    }
  },
  "servers": [
    {
      "url": "https://your-domain.com/api",
      "description": "Production server"
    }
  ],
  "paths": {
    "/next": {
      "get": {
        "summary": "Get next trips",
        "description": "Retrieve upcoming trips between two stations",
        "parameters": [
          {
            "name": "from",
            "in": "query",
            "description": "Origin station name",
            "required": true,
            "schema": {
              "type": "string",
              "example": "Union Station GO"
            }
          },
          {
            "name": "to",
            "in": "query",
            "description": "Destination station name",
            "required": true,
            "schema": {
              "type": "string",
              "example": "Ajax GO"
            }
          },
          {
            "name": "n",
            "in": "query",
            "description": "Number of trips to return (1-10)",
            "required": false,
            "schema": {
              "type": "integer",
              "minimum": 1,
              "maximum": 10,
              "default": 3,
              "example": 5
            }
          },
          {
            "name": "when",
            "in": "query",
            "description": "ISO timestamp for when to search from",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "example": "2024-01-15T14:30:00-05:00"
            }
          },
          {
            "name": "tz",
            "in": "query",
            "description": "Timezone for the search",
            "required": false,
            "schema": {
              "type": "string",
              "default": "America/Toronto",
              "example": "America/Toronto"
            }
          },
          {
            "name": "auto",
            "in": "query",
            "description": "Enable automatic direction detection using coordinates",
            "required": false,
            "schema": {
              "type": "string",
              "enum": ["0", "1"],
              "default": "0",
              "example": "1"
            }
          },
          {
            "name": "lat",
            "in": "query",
            "description": "Latitude for automatic direction detection (required when auto=1)",
            "required": false,
            "schema": {
              "type": "number",
              "format": "float",
              "example": 43.6532
            }
          },
          {
            "name": "lon",
            "in": "query",
            "description": "Longitude for automatic direction detection (required when auto=1)",
            "required": false,
            "schema": {
              "type": "number",
              "format": "float",
              "example": -79.3832
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved upcoming trips",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NextTripsResponse"
                },
                "example": {
                  "origin": "Union Station GO",
                  "destination": "Ajax GO",
                  "generated_at": "2024-01-15T14:30:00-05:00",
                  "trips": [
                    {
                      "departure_local": "14:45",
                      "arrival_local": "15:23",
                      "headsign": "Ajax GO",
                      "route": "Lakeshore East",
                      "trip_id": "12345",
                      "service_id": "weekday",
                      "notes": ["scheduled"]
                    }
                  ],
                  "attribution": "Data used with permission of Metrolinx."
                }
              }
            }
          },
          "400": {
            "description": "Bad request - missing required parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Station not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/route": {
      "get": {
        "summary": "Get route information",
        "description": "Retrieve all stations on a specific route",
        "parameters": [
          {
            "name": "route",
            "in": "query",
            "description": "Route name or identifier",
            "required": true,
            "schema": {
              "type": "string",
              "example": "Lakeshore East"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved route information",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RouteResponse"
                },
                "example": {
                  "route": "Lakeshore East",
                  "stations": [
                    {
                      "stop_id": "12345",
                      "stop_name": "Union Station GO",
                      "stop_sequence": 1,
                      "direction": "Ajax GO"
                    }
                  ],
                  "count": 15,
                  "attribution": "Data used with permission of Metrolinx."
                }
              }
            }
          },
          "400": {
            "description": "Bad request - missing route parameter",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Route not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/routes": {
      "get": {
        "summary": "Get all routes",
        "description": "Retrieve all available GO Transit routes",
        "responses": {
          "200": {
            "description": "Successfully retrieved all routes",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RoutesResponse"
                },
                "example": {
                  "routes": [
                    {
                      "route_id": "LSE",
                      "route_short_name": "LSE",
                      "route_long_name": "Lakeshore East",
                      "route_type": "2",
                      "station_count": 15
                    }
                  ],
                  "count": 7,
                  "attribution": "Data used with permission of Metrolinx."
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "Trip": {
        "type": "object",
        "properties": {
          "departure_local": {
            "type": "string",
            "description": "Local departure time in HH:mm format",
            "example": "14:45"
          },
          "arrival_local": {
            "type": "string",
            "description": "Local arrival time in HH:mm format",
            "example": "15:23"
          },
          "headsign": {
            "type": "string",
            "description": "Trip destination or headsign",
            "example": "Ajax GO"
          },
          "route": {
            "type": "string",
            "description": "Route name",
            "example": "Lakeshore East"
          },
          "trip_id": {
            "type": "string",
            "description": "Unique trip identifier",
            "example": "12345"
          },
          "service_id": {
            "type": "string",
            "description": "Service pattern identifier",
            "example": "weekday"
          },
          "notes": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Additional trip notes",
            "example": ["scheduled"]
          }
        }
      },
      "NextTripsResponse": {
        "type": "object",
        "properties": {
          "origin": {
            "type": "string",
            "description": "Origin station name",
            "example": "Union Station GO"
          },
          "destination": {
            "type": "string",
            "description": "Destination station name",
            "example": "Ajax GO"
          },
          "generated_at": {
            "type": "string",
            "format": "date-time",
            "description": "Timestamp when the response was generated",
            "example": "2024-01-15T14:30:00-05:00"
          },
          "trips": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Trip"
            },
            "description": "List of upcoming trips"
          },
          "attribution": {
            "type": "string",
            "description": "Data attribution notice",
            "example": "Data used with permission of Metrolinx."
          }
        }
      },
      "Station": {
        "type": "object",
        "properties": {
          "stop_id": {
            "type": "string",
            "description": "Unique stop identifier",
            "example": "12345"
          },
          "stop_name": {
            "type": "string",
            "description": "Station name",
            "example": "Union Station GO"
          },
          "stop_sequence": {
            "type": "integer",
            "description": "Position of station on the route",
            "example": 1
          },
          "direction": {
            "type": "string",
            "description": "Direction of travel",
            "example": "Ajax GO"
          }
        }
      },
      "RouteResponse": {
        "type": "object",
        "properties": {
          "route": {
            "type": "string",
            "description": "Route name",
            "example": "Lakeshore East"
          },
          "stations": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Station"
            },
            "description": "List of stations on the route"
          },
          "count": {
            "type": "integer",
            "description": "Number of stations on the route",
            "example": 15
          },
          "attribution": {
            "type": "string",
            "description": "Data attribution notice",
            "example": "Data used with permission of Metrolinx."
          }
        }
      },
      "RouteInfo": {
        "type": "object",
        "properties": {
          "route_id": {
            "type": "string",
            "description": "Unique route identifier",
            "example": "LSE"
          },
          "route_short_name": {
            "type": "string",
            "description": "Short route name",
            "example": "LSE"
          },
          "route_long_name": {
            "type": "string",
            "description": "Full route name",
            "example": "Lakeshore East"
          },
          "route_type": {
            "type": "string",
            "description": "Type of transit service",
            "example": "2"
          },
          "station_count": {
            "type": "integer",
            "description": "Number of stations on the route",
            "example": 15
          }
        }
      },
      "RoutesResponse": {
        "type": "object",
        "properties": {
          "routes": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/RouteInfo"
            },
            "description": "List of all available routes"
          },
          "count": {
            "type": "integer",
            "description": "Total number of routes",
            "example": 7
          },
          "attribution": {
            "type": "string",
            "description": "Data attribution notice",
            "example": "Data used with permission of Metrolinx."
          }
        }
      },
      "ErrorResponse": {
        "type": "object",
        "properties": {
          "error": {
            "type": "string",
            "description": "Error message",
            "example": "Provide from & to, or use auto=1&lat=&lon="
          }
        }
      }
    }
  }
}